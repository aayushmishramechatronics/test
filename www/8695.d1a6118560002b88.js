"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8695],{8695:(I,f,c)=>{c.r(f),c.d(f,{ShopKeeperPageModule:()=>J});var m=c(6895),d=c(4006),a=c(4881),g=c(7885),_=c(5861),p=c(5565),x=c(739),v=c(426),e=c(6353),y=c(1900),C=c(3748),M=c(8561);function b(s,r){if(1&s&&(e.TgZ(0,"ion-select-option"),e._uU(1),e.qZA()),2&s){const i=r.$implicit;e.xp6(1),e.Oqu(i.name)}}function A(s,r){if(1&s){const i=e.EpF();e.TgZ(0,"ion-select",22),e.NdJ("ngModelChange",function(n){e.CHM(i);const o=e.oxw(2);return e.KtG(o.selectedUser.name=n)}),e.YNc(1,b,2,1,"ion-select-option",21),e.qZA()}if(2&s){const i=e.oxw(2);e.Q6J("ngModel",i.selectedUser.name),e.xp6(1),e.Q6J("ngForOf",i.department.services)}}function T(s,r){if(1&s){const i=e.EpF();e.TgZ(0,"ion-input",23),e.NdJ("ngModelChange",function(n){e.CHM(i);const o=e.oxw(2);return e.KtG(o.selectedUser.name=n)}),e.qZA()}if(2&s){const i=e.oxw(2);e.Q6J("ngModel",i.selectedUser.name)}}function U(s,r){if(1&s&&(e.TgZ(0,"ion-select-option",26),e._uU(1),e.qZA()),2&s){const i=r.$implicit;e.Q6J("value",i),e.xp6(1),e.Oqu(i.formattedAddress)}}function Z(s,r){if(1&s){const i=e.EpF();e.TgZ(0,"ion-item")(1,"ion-label",12),e._uU(2,"Location"),e.TgZ(3,"ion-text",13),e._uU(4,"*"),e.qZA()(),e.TgZ(5,"ion-select",24),e.NdJ("ionChange",function(n){e.CHM(i);const o=e.oxw(2);return e.KtG(o.onLocationChange(n))}),e.YNc(6,U,2,2,"ion-select-option",25),e.qZA()()}if(2&s){const i=e.oxw(2);e.xp6(5),e.Q6J("selectedText",null==i.selectedLocation?null:i.selectedLocation.formattedAddress),e.xp6(1),e.Q6J("ngForOf",i.locations)}}function S(s,r){if(1&s){const i=e.EpF();e.ynx(0),e.TgZ(1,"ion-row")(2,"ion-col")(3,"ion-item",27)(4,"ion-label"),e._uU(5,"Open Time"),e.qZA(),e.TgZ(6,"ion-datetime",30),e.NdJ("ngModelChange",function(n){e.CHM(i);const o=e.oxw().$implicit;return e.KtG(o.startTime=n)}),e.qZA()()(),e.TgZ(7,"ion-col")(8,"ion-item",27)(9,"ion-label"),e._uU(10,"Close Time"),e.qZA(),e.TgZ(11,"ion-datetime",30),e.NdJ("ngModelChange",function(n){e.CHM(i);const o=e.oxw().$implicit;return e.KtG(o.endTime=n)}),e.qZA()()()(),e.TgZ(12,"ion-row")(13,"ion-col")(14,"ion-item")(15,"ion-label",12),e._uU(16,"Slot Duration"),e.TgZ(17,"ion-text",13),e._uU(18,"*"),e.qZA()(),e.TgZ(19,"ion-input",31),e.NdJ("ngModelChange",function(n){e.CHM(i);const o=e.oxw().$implicit;return e.KtG(o.durationInMin=n)}),e.qZA()()(),e.TgZ(20,"ion-col")(21,"ion-item")(22,"ion-label",12),e._uU(23,"Customers Per Slot"),e.TgZ(24,"ion-text",13),e._uU(25,"*"),e.qZA()(),e.TgZ(26,"ion-input",31),e.NdJ("ngModelChange",function(n){e.CHM(i);const o=e.oxw().$implicit;return e.KtG(o.slotLimit=n)}),e.qZA()()()(),e.BQk()}if(2&s){const i=e.oxw(),t=i.$implicit,n=i.index;e.xp6(6),e.Q6J("ngModel",t.startTime)("name","opnTime"+n),e.xp6(5),e.Q6J("ngModel",t.endTime)("name","closeTime"+n),e.xp6(8),e.Q6J("ngModel",t.durationInMin)("value",t.durationInMin)("name","slotDuration"+n),e.xp6(7),e.Q6J("ngModel",t.slotLimit)("value",t.slotLimit)("name","CustomersSlot"+n)}}function P(s,r){if(1&s){const i=e.EpF();e.TgZ(0,"ion-item")(1,"ion-grid")(2,"ion-row")(3,"ion-col")(4,"ion-item",27)(5,"p",28),e._uU(6),e.ALo(7,"trimunit"),e.qZA(),e.TgZ(8,"ion-toggle",29),e.NdJ("ngModelChange",function(n){const l=e.CHM(i).$implicit;return e.KtG(l.checked=n)}),e.qZA()()()(),e.YNc(9,S,27,10,"ng-container",3),e.qZA()()}if(2&s){const i=r.$implicit,t=r.index;e.xp6(6),e.Oqu(i.day?e.xi3(7,4,i.day,3):"-"),e.xp6(2),e.Q6J("ngModel",i.checked)("name",t+"checked"),e.xp6(1),e.Q6J("ngIf",i.checked)}}function O(s,r){if(1&s){const i=e.EpF();e.ynx(0),e.TgZ(1,"ion-grid",7)(2,"ion-row")(3,"ion-label",8),e._uU(4,"Fill below details to complete your setup"),e.qZA()()(),e.TgZ(5,"ion-grid",9)(6,"ion-row",10)(7,"ion-col",11)(8,"ion-item")(9,"ion-label",12),e._uU(10),e.TgZ(11,"ion-text",13),e._uU(12,"*"),e.qZA()(),e.YNc(13,A,2,2,"ion-select",14),e.YNc(14,T,1,1,"ion-input",15),e.qZA(),e.TgZ(15,"ion-item")(16,"ion-label",12),e._uU(17,"Description"),e.TgZ(18,"ion-text",13),e._uU(19,"*"),e.qZA()(),e.TgZ(20,"ion-textarea",16),e.NdJ("ngModelChange",function(n){e.CHM(i);const o=e.oxw();return e.KtG(o.selectedUser.description=n)}),e.qZA()(),e.TgZ(21,"ion-item")(22,"ion-label",17),e._uU(23,"Mobile Number "),e.TgZ(24,"ion-text",13),e._uU(25,"*"),e.qZA()(),e.TgZ(26,"ion-text"),e._uU(27),e.ALo(28,"parseNumber"),e.qZA()(),e.TgZ(29,"ion-item")(30,"ion-label",12),e._uU(31),e.qZA(),e.TgZ(32,"ion-textarea",18),e.NdJ("ngModelChange",function(n){e.CHM(i);const o=e.oxw();return e.KtG(o.selectedUser.formattedAddress=n)}),e.qZA()(),e.YNc(33,Z,7,2,"ion-item",3),e.qZA(),e._UZ(34,"ion-col",19),e.TgZ(35,"ion-col",20),e.YNc(36,P,10,7,"ion-item",21),e.qZA()()(),e.BQk()}if(2&s){const i=e.oxw();e.xp6(10),e.hij("",i.vendorDeatil?i.vendorDeatil.serviceLabel:"Shop"," Name "),e.xp6(3),e.Q6J("ngIf",i.vendorDeatil.conceirge&&i.department),e.xp6(1),e.Q6J("ngIf",!i.vendorDeatil.conceirge),e.xp6(6),e.Q6J("ngModel",i.selectedUser.description),e.xp6(7),e.Oqu(e.lcZ(28,9,i.selectedUser.phonenumber)),e.xp6(4),e.Oqu(i.vendorDeatil.addressLabel?i.vendorDeatil.addressLabel:"Address"),e.xp6(1),e.Q6J("ngModel",i.selectedUser.formattedAddress),e.xp6(1),e.Q6J("ngIf",i.vendorDeatil.updateShopLocation),e.xp6(3),e.Q6J("ngForOf",i.selectedUser.availableDays)}}const k=[{path:"",component:(()=>{const r=class{constructor(t,n,o,l,h,u){this.appService=t,this.router=n,this.modalCtrl=o,this.activatedRoute=l,this.utilAlertService=h,this.loadingController=u,this.daysInWeek=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],this.addressList=[],this.locations=[],this.firstTime=!0,this.departments=[],this.user=new p.rB,this.selectedUser=new p.rB,this.getUserDetail(),this.getVendorDetail()}ngOnInit(){}ionViewWillEnter(){this.activatedRoute.params.subscribe(t=>{t&&(this.storeId=t.id),this.selectedAddress=void 0,this.addressList=[],this.getLocations(),this.user=JSON.parse(localStorage.getItem("user")),this.getAllServices(),this.user||(this.user=new p.rB),this.setAvailableDays()})}getCategory(){this.appService.getCategory().subscribe(t=>{t&&t.body&&t.body.length&&(this.categories=t.body)})}getAllServices(){this.department=this.departments.find(t=>{if(t&&t.name===this.user.name)return t})}onServiceChange(t){}onLocationChange(t){t&&t.detail&&t.detail.value&&(this.selectedLocation=t.detail.value)}getLocations(){this.appService.getCity().subscribe(t=>{t&&t.body&&t.body.length&&(this.locations=t.body,this.selectedUser&&this.locations&&this.locations.length&&(this.selectedLocation=this.locations.find(n=>n.locationId===this.selectedUser.locationId)))})}setAdminAvailableDays(){this.selectedUser=this.user,this.selectedUser.formattedAddress&&(this.selectedAddress={lng:this.selectedUser.lng,lat:this.selectedUser.lat,photoReference:this.selectedUser.photoReference,formattedAddress:this.selectedUser.formattedAddress}),this.daysInWeek.forEach(t=>{const n=new p.$H;n.day=t;const o=this.selectedUser.availableDays.findIndex(l=>l.day===n.day);-1===o?this.selectedUser.availableDays.push(n):this.selectedUser.availableDays[o].checked=!0})}setAvailableDays(){this.storeId?(this.selectedUser=this.user.shops.find(t=>t.phonenumber===this.storeId),this.selectedUser&&(this.selectedUser.formattedAddress&&(this.selectedAddress={lng:this.selectedUser.lng,lat:this.selectedUser.lat,photoReference:this.selectedUser.photoReference,formattedAddress:this.selectedUser.formattedAddress}),this.daysInWeek.forEach(t=>{const n=new p.$H;n.day=t;const o=this.selectedUser.availableDays.findIndex(l=>l.day===n.day);-1===o?this.selectedUser.availableDays.push(n):this.selectedUser.availableDays[o].checked=!0}))):this.setAdminAvailableDays()}checkIfSlotschecked(){let t=!1;if(this.selectedUser&&this.selectedUser.availableDays)for(const n of this.selectedUser.availableDays)if(n.checked){t=!0;break}return t}successModal(){var t=this;return(0,_.Z)(function*(n=""){return yield(yield t.modalCtrl.create({cssClass:"login-modal-page",animated:!0,showBackdrop:!0,component:v.f,componentProps:{type:t.selectedUser.type,msg:n}})).present()}).apply(this,arguments)}dismiss(){var t=this;return(0,_.Z)(function*(){yield t.modalCtrl.dismiss()})()}convertDetailBeforeSave(){return this.selectedUser.availableDays.filter(t=>t.checked)}save(){var t=this;return(0,_.Z)(function*(){let n=!0;if(!t.selectedUser.name)return n=!1,void t.utilAlertService.showAlert("Please Enter Name");if(!t.selectedUser.phonenumber)return n=!1,void t.utilAlertService.showAlert("Please Enter Phone Number");if(t.vendorDeatil.updateShopLocation&&!t.selectedLocation)return n=!1,void t.utilAlertService.showAlert("Please select Location");if(!t.checkIfSlotschecked())return n=!1,void t.utilAlertService.showAlert("Please select the slots");if(n&&t.selectedUser){t.selectedUser.availableDays=t.convertDetailBeforeSave(),t.selectedLocation&&(t.selectedUser.locationId=t.selectedLocation.locationId),t.selectedUser.idCategory=t.vendorDeatil.idCategory;const o=yield t.loadingController.create({message:"Loading..."});yield o.present(),t.appService.createStore(t.selectedUser).subscribe(l=>{if(o.dismiss(),l&&l.body){if("A"===t.user.type){const h=t.user.shops.findIndex(u=>u.userId===l.body.userId);-1!==h&&(t.user.shops[h]=l.body)}else t.user=l.body;t.successModal(),setTimeout(()=>{t.dismiss(),t.appService.setUserDetail(t.user),localStorage.setItem("user",JSON.stringify(t.user)),t.selectedUser=new p.rB,t.router.navigate("A"===t.user.type?["/user-shops"]:["/booked-customers"])},2e3)}},()=>{o.dismiss()})}})()}getUserDetail(){this.appService.userDetail.subscribe(t=>{this.user=t})}getVendorDetail(){this.appService.vendorDeatil.subscribe(t=>{t&&(this.vendorDeatil=t,this.departments=this.vendorDeatil.departments)})}searchAddress(t){this.selectedAddress=void 0;const n=t.target.value;this.addressList=[],n&&this.appService.searchShopAddress({query:n}).subscribe(l=>{console.log(l),l&&l.body&&(this.addressList=l.body)})}selectAddress(t){this.selectedAddress=t,this.addressList=[]}};let s=r;return r.\u0275fac=function(n){return new(n||r)(e.Y36(x.z),e.Y36(g.F0),e.Y36(a.IN),e.Y36(g.gz),e.Y36(y.F),e.Y36(a.HT))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-shop-keeper"]],decls:9,vars:1,consts:[[1,"container"],["name","form1",1,"shop-form"],["shopForm","ngForm"],[4,"ngIf"],[1,"shop-keeper-btn-container"],["name","submit","size","default","expand","primary","tappable","",1,"book-appointment-btn",3,"click"],[1,"mr-1"],[2,"margin","8pt 16pt"],[2,"font-size","12pt"],[1,"shop-keeper-grid"],[1,"shop-keeper-row"],[1,"shop-keeper-col","shop-keeper-detail"],["position","stacked"],["color","danger"],["name","firstname","interface","action-sheet",3,"ngModel","ngModelChange",4,"ngIf"],["type","text","name","shopName","required","",3,"ngModel","ngModelChange",4,"ngIf"],["name","desc","required","",3,"ngModel","ngModelChange"],["position","stacked",2,"opacity","1"],["name","address",3,"ngModel","ngModelChange"],["size","auto",1,"v-divider","ion-no-padding"],[1,"shop-keeper-col","shop-keeper-slot-detail"],[4,"ngFor","ngForOf"],["name","firstname","interface","action-sheet",3,"ngModel","ngModelChange"],["type","text","name","shopName","required","",3,"ngModel","ngModelChange"],["interface","action-sheet",3,"selectedText","ionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["lines","none"],[2,"width","25%"],[3,"ngModel","name","ngModelChange"],["display-format","hh:mm A","placeholder","hh:mm a","picker-format","hh:mm a","required","",3,"ngModel","name","ngModelChange"],["type","text","required","",3,"ngModel","value","name","ngModelChange"]],template:function(n,o){1&n&&(e.TgZ(0,"ion-content")(1,"div",0)(2,"form",1,2),e.YNc(4,O,37,11,"ng-container",3),e.qZA(),e.TgZ(5,"div",4)(6,"ion-button",5),e.NdJ("click",function(){return o.save()}),e.TgZ(7,"span",6),e._uU(8,"Save"),e.qZA()()()()()),2&n&&(e.xp6(4),e.Q6J("ngIf",o.user))},dependencies:[m.sg,m.O5,d._Y,d.JJ,d.JL,d.Q7,d.On,d.F,a.YG,a.wI,a.W2,a.x4,a.jY,a.pK,a.Ie,a.Q$,a.Nd,a.t9,a.n0,a.yW,a.g2,a.ho,a.w,a.QI,a.j9,C._,M.i],styles:[".shop-form[_ngcontent-%COMP%]{height:calc(100% - 50px);overflow-y:auto}.shop-form[_ngcontent-%COMP%]   .shop-keeper-grid[_ngcontent-%COMP%]   .shop-keeper-row[_ngcontent-%COMP%]{display:grid;grid-column-gap:10px;grid-row-gap:9px}.shop-form[_ngcontent-%COMP%]   .shop-keeper-grid[_ngcontent-%COMP%]   .shop-keeper-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{display:block}.shop-form[_ngcontent-%COMP%]   .shop-keeper-grid[_ngcontent-%COMP%]   .shop-keeper-row[_ngcontent-%COMP%]   .shop-address-search[_ngcontent-%COMP%]{padding-left:0;padding-right:0}.shop-form[_ngcontent-%COMP%]   .shop-keeper-grid[_ngcontent-%COMP%]   .shop-keeper-row[_ngcontent-%COMP%]   .shop-address-search[_ngcontent-%COMP%]   .searchbar-input-container.sc-ion-searchbar-md[_ngcontent-%COMP%]{--box-shadow: none !important;border-bottom:1px solid rgba(84,80,80,.25)!important}.shop-form[_ngcontent-%COMP%]   .shop-keeper-grid[_ngcontent-%COMP%]   .shop-keeper-row[_ngcontent-%COMP%]   .v-divider[_ngcontent-%COMP%]{width:1px!important;padding:0;font-size:1px;flex:none;max-width:1px!important;border-right:1px solid #dcdcdc}.shop-form[_ngcontent-%COMP%]   .shop-keeper-grid[_ngcontent-%COMP%]   .sc-ion-label-md-h[_ngcontent-%COMP%]{font-size:12pt!important}.shop-keeper-btn-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding:4pt 16pt;position:fixed;width:100%;left:0;bottom:0;height:50px;z-index:1;margin:0}.native-input[disabled][_ngcontent-%COMP%]{opacity:1!important}"]}),s})()}];let w=(()=>{const r=class{};let s=r;return r.\u0275fac=function(n){return new(n||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[g.Bz.forChild(k),g.Bz]}),s})();var D=c(5642);let J=(()=>{const r=class{};let s=r;return r.\u0275fac=function(n){return new(n||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[m.ez,d.u5,a.Pc,D.K,w]}),s})()}}]);