"use strict";(self.webpackChunkschedulingApp=self.webpackChunkschedulingApp||[]).push([[4298],{4298:function(e,t,i){i.r(t),i.d(t,{ShopKeeperPageModule:function(){return q}});var n=i(12057),s=i(24751),o=i(46982),r=i(13644),d=i(97582),a=i(65565),l=i(85386),c=i(60426),h=i(292),g=i(51900),p=i(48561),u=i(73748);function m(e,t){if(1&e&&(h.TgZ(0,"ion-select-option"),h._uU(1),h.qZA()),2&e){const e=t.$implicit;h.xp6(1),h.Oqu(e.name)}}function f(e,t){if(1&e){const e=h.EpF();h.TgZ(0,"ion-select",22),h.NdJ("ngModelChange",function(t){return h.CHM(e),h.oxw(2).selectedUser.name=t}),h.YNc(1,m,2,1,"ion-select-option",21),h.qZA()}if(2&e){const e=h.oxw(2);h.Q6J("ngModel",e.selectedUser.name),h.xp6(1),h.Q6J("ngForOf",e.department.services)}}function Z(e,t){if(1&e){const e=h.EpF();h.TgZ(0,"ion-input",23),h.NdJ("ngModelChange",function(t){return h.CHM(e),h.oxw(2).selectedUser.name=t}),h.qZA()}if(2&e){const e=h.oxw(2);h.Q6J("ngModel",e.selectedUser.name)}}function A(e,t){if(1&e&&(h.TgZ(0,"ion-select-option",26),h._uU(1),h.qZA()),2&e){const e=t.$implicit;h.Q6J("value",e),h.xp6(1),h.Oqu(e.formattedAddress)}}function v(e,t){if(1&e){const e=h.EpF();h.TgZ(0,"ion-item"),h.TgZ(1,"ion-label",12),h._uU(2,"Location"),h.TgZ(3,"ion-text",13),h._uU(4,"*"),h.qZA(),h.qZA(),h.TgZ(5,"ion-select",24),h.NdJ("ionChange",function(t){return h.CHM(e),h.oxw(2).onLocationChange(t)}),h.YNc(6,A,2,2,"ion-select-option",25),h.qZA(),h.qZA()}if(2&e){const e=h.oxw(2);h.xp6(5),h.Q6J("selectedText",null==e.selectedLocation?null:e.selectedLocation.formattedAddress),h.xp6(1),h.Q6J("ngForOf",e.locations)}}function b(e,t){if(1&e){const e=h.EpF();h.ynx(0),h.TgZ(1,"ion-row"),h.TgZ(2,"ion-col"),h.TgZ(3,"ion-item",27),h.TgZ(4,"ion-label"),h._uU(5,"Open Time"),h.qZA(),h.TgZ(6,"ion-datetime",30),h.NdJ("ngModelChange",function(t){return h.CHM(e),h.oxw().$implicit.startTime=t}),h.qZA(),h.qZA(),h.qZA(),h.TgZ(7,"ion-col"),h.TgZ(8,"ion-item",27),h.TgZ(9,"ion-label"),h._uU(10,"Close Time"),h.qZA(),h.TgZ(11,"ion-datetime",30),h.NdJ("ngModelChange",function(t){return h.CHM(e),h.oxw().$implicit.endTime=t}),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(12,"ion-row"),h.TgZ(13,"ion-col"),h.TgZ(14,"ion-item"),h.TgZ(15,"ion-label",12),h._uU(16,"Slot Duration"),h.TgZ(17,"ion-text",13),h._uU(18,"*"),h.qZA(),h.qZA(),h.TgZ(19,"ion-input",31),h.NdJ("ngModelChange",function(t){return h.CHM(e),h.oxw().$implicit.durationInMin=t}),h.qZA(),h.qZA(),h.qZA(),h.TgZ(20,"ion-col"),h.TgZ(21,"ion-item"),h.TgZ(22,"ion-label",12),h._uU(23,"Customers Per Slot"),h.TgZ(24,"ion-text",13),h._uU(25,"*"),h.qZA(),h.qZA(),h.TgZ(26,"ion-input",31),h.NdJ("ngModelChange",function(t){return h.CHM(e),h.oxw().$implicit.slotLimit=t}),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.BQk()}if(2&e){const e=h.oxw(),t=e.$implicit,i=e.index;h.xp6(6),h.Q6J("ngModel",t.startTime)("name","opnTime"+i),h.xp6(5),h.Q6J("ngModel",t.endTime)("name","closeTime"+i),h.xp6(8),h.Q6J("ngModel",t.durationInMin)("value",t.durationInMin)("name","slotDuration"+i),h.xp6(7),h.Q6J("ngModel",t.slotLimit)("value",t.slotLimit)("name","CustomersSlot"+i)}}function y(e,t){if(1&e){const e=h.EpF();h.TgZ(0,"ion-item"),h.TgZ(1,"ion-grid"),h.TgZ(2,"ion-row"),h.TgZ(3,"ion-col"),h.TgZ(4,"ion-item",27),h.TgZ(5,"p",28),h._uU(6),h.ALo(7,"trimunit"),h.qZA(),h.TgZ(8,"ion-toggle",29),h.NdJ("ngModelChange",function(t){return h.CHM(e).$implicit.checked=t}),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.YNc(9,b,27,10,"ng-container",3),h.qZA(),h.qZA()}if(2&e){const e=t.$implicit,i=t.index;h.xp6(6),h.Oqu(e.day?h.xi3(7,4,e.day,3):"-"),h.xp6(2),h.Q6J("ngModel",e.checked)("name",i+"checked"),h.xp6(1),h.Q6J("ngIf",e.checked)}}function M(e,t){if(1&e){const e=h.EpF();h.ynx(0),h.TgZ(1,"ion-grid",7),h.TgZ(2,"ion-row"),h.TgZ(3,"ion-label",8),h._uU(4,"Fill below details to complete your setup"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(5,"ion-grid",9),h.TgZ(6,"ion-row",10),h.TgZ(7,"ion-col",11),h.TgZ(8,"ion-item"),h.TgZ(9,"ion-label",12),h._uU(10),h.TgZ(11,"ion-text",13),h._uU(12,"*"),h.qZA(),h.qZA(),h.YNc(13,f,2,2,"ion-select",14),h.YNc(14,Z,1,1,"ion-input",15),h.qZA(),h.TgZ(15,"ion-item"),h.TgZ(16,"ion-label",12),h._uU(17,"Description"),h.TgZ(18,"ion-text",13),h._uU(19,"*"),h.qZA(),h.qZA(),h.TgZ(20,"ion-textarea",16),h.NdJ("ngModelChange",function(t){return h.CHM(e),h.oxw().selectedUser.description=t}),h.qZA(),h.qZA(),h.TgZ(21,"ion-item"),h.TgZ(22,"ion-label",17),h._uU(23,"Mobile Number "),h.TgZ(24,"ion-text",13),h._uU(25,"*"),h.qZA(),h.qZA(),h.TgZ(26,"ion-text"),h._uU(27),h.ALo(28,"parseNumber"),h.qZA(),h.qZA(),h.TgZ(29,"ion-item"),h.TgZ(30,"ion-label",12),h._uU(31),h.qZA(),h.TgZ(32,"ion-textarea",18),h.NdJ("ngModelChange",function(t){return h.CHM(e),h.oxw().selectedUser.formattedAddress=t}),h.qZA(),h.qZA(),h.YNc(33,v,7,2,"ion-item",3),h.qZA(),h._UZ(34,"ion-col",19),h.TgZ(35,"ion-col",20),h.YNc(36,y,10,7,"ion-item",21),h.qZA(),h.qZA(),h.qZA(),h.BQk()}if(2&e){const e=h.oxw();h.xp6(10),h.hij("",e.vendorDeatil?e.vendorDeatil.serviceLabel:"Shop"," Name "),h.xp6(3),h.Q6J("ngIf",e.vendorDeatil.conceirge&&e.department),h.xp6(1),h.Q6J("ngIf",!e.vendorDeatil.conceirge),h.xp6(6),h.Q6J("ngModel",e.selectedUser.description),h.xp6(7),h.Oqu(h.lcZ(28,9,e.selectedUser.phonenumber)),h.xp6(4),h.Oqu(e.vendorDeatil.addressLabel?e.vendorDeatil.addressLabel:"Address"),h.xp6(1),h.Q6J("ngModel",e.selectedUser.formattedAddress),h.xp6(1),h.Q6J("ngIf",e.vendorDeatil.updateShopLocation),h.xp6(3),h.Q6J("ngForOf",e.selectedUser.availableDays)}}const T=[{path:"",component:(()=>{class e{constructor(e,t,i,n,s,o){this.appService=e,this.router=t,this.modalCtrl=i,this.activatedRoute=n,this.utilAlertService=s,this.loadingController=o,this.daysInWeek=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],this.addressList=[],this.locations=[],this.firstTime=!0,this.departments=[],this.user=new a.rB,this.selectedUser=new a.rB,this.getUserDetail(),this.getVendorDetail()}ngOnInit(){}ionViewWillEnter(){this.activatedRoute.params.subscribe(e=>{e&&(this.storeId=e.id),this.selectedAddress=void 0,this.addressList=[],this.getLocations(),this.user=JSON.parse(localStorage.getItem("user")),this.getAllServices(),this.user||(this.user=new a.rB),this.setAvailableDays()})}getCategory(){this.appService.getCategory().subscribe(e=>{e&&e.body&&e.body.length&&(this.categories=e.body)})}getAllServices(){this.department=this.departments.find(e=>{if(e&&e.name===this.user.name)return e})}onServiceChange(e){}onLocationChange(e){e&&e.detail&&e.detail.value&&(this.selectedLocation=e.detail.value)}getLocations(){this.appService.getCity().subscribe(e=>{e&&e.body&&e.body.length&&(this.locations=e.body,this.selectedUser&&this.locations&&this.locations.length&&(this.selectedLocation=this.locations.find(e=>e.locationId===this.selectedUser.locationId)))})}setAdminAvailableDays(){this.selectedUser=this.user,this.selectedUser.formattedAddress&&(this.selectedAddress={lng:this.selectedUser.lng,lat:this.selectedUser.lat,photoReference:this.selectedUser.photoReference,formattedAddress:this.selectedUser.formattedAddress}),this.daysInWeek.forEach(e=>{const t=new a.$H;t.day=e;const i=this.selectedUser.availableDays.findIndex(e=>e.day===t.day);-1===i?this.selectedUser.availableDays.push(t):this.selectedUser.availableDays[i].checked=!0})}setAvailableDays(){this.storeId?(this.selectedUser=this.user.shops.find(e=>e.phonenumber===this.storeId),this.selectedUser&&(this.selectedUser.formattedAddress&&(this.selectedAddress={lng:this.selectedUser.lng,lat:this.selectedUser.lat,photoReference:this.selectedUser.photoReference,formattedAddress:this.selectedUser.formattedAddress}),this.daysInWeek.forEach(e=>{const t=new a.$H;t.day=e;const i=this.selectedUser.availableDays.findIndex(e=>e.day===t.day);-1===i?this.selectedUser.availableDays.push(t):this.selectedUser.availableDays[i].checked=!0}))):this.setAdminAvailableDays()}checkIfSlotschecked(){let e=!1;if(this.selectedUser&&this.selectedUser.availableDays)for(const t of this.selectedUser.availableDays)if(t.checked){e=!0;break}return e}successModal(e=""){return(0,d.mG)(this,void 0,void 0,function*(){return yield(yield this.modalCtrl.create({cssClass:"login-modal-page",animated:!0,showBackdrop:!0,component:c.f,componentProps:{type:this.selectedUser.type,msg:e}})).present()})}dismiss(){return(0,d.mG)(this,void 0,void 0,function*(){yield this.modalCtrl.dismiss()})}convertDetailBeforeSave(){return this.selectedUser.availableDays.filter(e=>e.checked)}save(){return(0,d.mG)(this,void 0,void 0,function*(){let e=!0;if(!this.selectedUser.name)return e=!1,void this.utilAlertService.showAlert("Please Enter Name");if(!this.selectedUser.phonenumber)return e=!1,void this.utilAlertService.showAlert("Please Enter Phone Number");if(this.vendorDeatil.updateShopLocation&&!this.selectedLocation)return e=!1,void this.utilAlertService.showAlert("Please select Location");if(!this.checkIfSlotschecked())return e=!1,void this.utilAlertService.showAlert("Please select the slots");if(e&&this.selectedUser){this.selectedUser.availableDays=this.convertDetailBeforeSave(),this.selectedLocation&&(this.selectedUser.locationId=this.selectedLocation.locationId),this.selectedUser.idCategory=this.vendorDeatil.idCategory;const e=yield this.loadingController.create({message:"Loading..."});yield e.present(),this.appService.createStore(this.selectedUser).subscribe(t=>{if(e.dismiss(),t&&t.body){if("A"===this.user.type){const e=this.user.shops.findIndex(e=>e.userId===t.body.userId);-1!==e&&(this.user.shops[e]=t.body)}else this.user=t.body;this.successModal(),setTimeout(()=>{this.dismiss(),this.appService.setUserDetail(this.user),localStorage.setItem("user",JSON.stringify(this.user)),this.selectedUser=new a.rB,this.router.navigate("A"===this.user.type?["/user-shops"]:["/booked-customers"])},2e3)}},()=>{e.dismiss()})}})}getUserDetail(){this.appService.userDetail.subscribe(e=>{this.user=e})}getVendorDetail(){this.appService.vendorDeatil.subscribe(e=>{e&&(this.vendorDeatil=e,this.departments=this.vendorDeatil.departments)})}searchAddress(e){this.selectedAddress=void 0;const t=e.target.value;this.addressList=[],t&&this.appService.searchShopAddress({query:t}).subscribe(e=>{console.log(e),e&&e.body&&(this.addressList=e.body)})}selectAddress(e){this.selectedAddress=e,this.addressList=[]}}return e.\u0275fac=function(t){return new(t||e)(h.Y36(l.z),h.Y36(r.F0),h.Y36(o.IN),h.Y36(r.gz),h.Y36(g.F),h.Y36(o.HT))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-shop-keeper"]],decls:9,vars:1,consts:[[1,"container"],["name","form1",1,"shop-form"],["shopForm","ngForm"],[4,"ngIf"],[1,"shop-keeper-btn-container"],["name","submit","size","default","expand","primary","tappable","",1,"book-appointment-btn",3,"click"],[1,"mr-1"],[2,"margin","8pt 16pt"],[2,"font-size","12pt"],[1,"shop-keeper-grid"],[1,"shop-keeper-row"],[1,"shop-keeper-col","shop-keeper-detail"],["position","stacked"],["color","danger"],["name","firstname","interface","action-sheet",3,"ngModel","ngModelChange",4,"ngIf"],["type","text","name","shopName","required","",3,"ngModel","ngModelChange",4,"ngIf"],["name","desc","required","",3,"ngModel","ngModelChange"],["position","stacked",2,"opacity","1"],["name","address",3,"ngModel","ngModelChange"],["size","auto",1,"v-divider","ion-no-padding"],[1,"shop-keeper-col","shop-keeper-slot-detail"],[4,"ngFor","ngForOf"],["name","firstname","interface","action-sheet",3,"ngModel","ngModelChange"],["type","text","name","shopName","required","",3,"ngModel","ngModelChange"],["interface","action-sheet",3,"selectedText","ionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["lines","none"],[2,"width","25%"],[3,"ngModel","name","ngModelChange"],["display-format","hh:mm A","placeholder","hh:mm a","picker-format","hh:mm a","required","",3,"ngModel","name","ngModelChange"],["type","text","required","",3,"ngModel","value","name","ngModelChange"]],template:function(e,t){1&e&&(h.TgZ(0,"ion-content"),h.TgZ(1,"div",0),h.TgZ(2,"form",1,2),h.YNc(4,M,37,11,"ng-container",3),h.qZA(),h.TgZ(5,"div",4),h.TgZ(6,"ion-button",5),h.NdJ("click",function(){return t.save()}),h.TgZ(7,"span",6),h._uU(8,"Save"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.xp6(4),h.Q6J("ngIf",t.user))},directives:[o.W2,s._Y,s.JL,s.F,n.O5,o.YG,o.jY,o.Nd,o.Q$,o.wI,o.Ie,o.yW,o.j9,o.g2,s.Q7,s.JJ,s.On,n.sg,o.t9,o.QI,o.n0,o.pK,o.ho,o.w,o.x4],pipes:[p.i,u._],styles:[".shop-form[_ngcontent-%COMP%]{height:calc(100% - 50px);overflow-y:auto}.shop-form[_ngcontent-%COMP%]   .shop-keeper-grid[_ngcontent-%COMP%]   .shop-keeper-row[_ngcontent-%COMP%]{display:grid;grid-column-gap:10px;grid-row-gap:9px}.shop-form[_ngcontent-%COMP%]   .shop-keeper-grid[_ngcontent-%COMP%]   .shop-keeper-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{display:block}.shop-form[_ngcontent-%COMP%]   .shop-keeper-grid[_ngcontent-%COMP%]   .shop-keeper-row[_ngcontent-%COMP%]   .shop-address-search[_ngcontent-%COMP%]{padding-left:0;padding-right:0}.shop-form[_ngcontent-%COMP%]   .shop-keeper-grid[_ngcontent-%COMP%]   .shop-keeper-row[_ngcontent-%COMP%]   .shop-address-search[_ngcontent-%COMP%]   .searchbar-input-container.sc-ion-searchbar-md[_ngcontent-%COMP%]{--box-shadow: none !important;border-bottom:1px solid rgba(84,80,80,.25)!important}.shop-form[_ngcontent-%COMP%]   .shop-keeper-grid[_ngcontent-%COMP%]   .shop-keeper-row[_ngcontent-%COMP%]   .v-divider[_ngcontent-%COMP%]{width:1px!important;padding:0;font-size:1px;flex:none;max-width:1px!important;border-right:1px solid #dcdcdc}.shop-form[_ngcontent-%COMP%]   .shop-keeper-grid[_ngcontent-%COMP%]   .sc-ion-label-md-h[_ngcontent-%COMP%]{font-size:12pt!important}.shop-keeper-btn-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding:4pt 16pt;position:fixed;width:100%;left:0;bottom:0;height:50px;z-index:1;margin:0}.native-input[disabled][_ngcontent-%COMP%]{opacity:1!important}"]}),e})()}];let x=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=h.oAB({type:e}),e.\u0275inj=h.cJS({imports:[[r.Bz.forChild(T)],r.Bz]}),e})();var C=i(45642);let q=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=h.oAB({type:e}),e.\u0275inj=h.cJS({imports:[[n.ez,s.u5,o.Pc,C.K,x]]}),e})()}}]);