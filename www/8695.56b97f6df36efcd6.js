"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8695],{8695:(D,u,l)=>{l.r(u),l.d(u,{ShopKeeperPageModule:()=>w});var h=l(6895),d=l(4006),r=l(4881),g=l(7885),_=l(5861),c=l(5565),f=l(739),x=l(426),e=l(6353),M=l(1900),v=l(3748),y=l(8561);function C(o,a){if(1&o&&(e.TgZ(0,"ion-select-option"),e._uU(1),e.qZA()),2&o){const t=a.$implicit;e.xp6(1),e.Oqu(t.name)}}function b(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"ion-select",22),e.NdJ("ngModelChange",function(i){e.CHM(t);const s=e.oxw(2);return e.KtG(s.selectedUser.name=i)}),e.YNc(1,C,2,1,"ion-select-option",21),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("ngModel",t.selectedUser.name),e.xp6(1),e.Q6J("ngForOf",t.department.services)}}function A(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"ion-input",23),e.NdJ("ngModelChange",function(i){e.CHM(t);const s=e.oxw(2);return e.KtG(s.selectedUser.name=i)}),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("ngModel",t.selectedUser.name)}}function T(o,a){if(1&o&&(e.TgZ(0,"ion-select-option",26),e._uU(1),e.qZA()),2&o){const t=a.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t.formattedAddress)}}function U(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"ion-item")(1,"ion-label",12),e._uU(2,"Location"),e.TgZ(3,"ion-text",13),e._uU(4,"*"),e.qZA()(),e.TgZ(5,"ion-select",24),e.NdJ("ionChange",function(i){e.CHM(t);const s=e.oxw(2);return e.KtG(s.onLocationChange(i))}),e.YNc(6,T,2,2,"ion-select-option",25),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(5),e.Q6J("selectedText",null==t.selectedLocation?null:t.selectedLocation.formattedAddress),e.xp6(1),e.Q6J("ngForOf",t.locations)}}function Z(o,a){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"ion-row")(2,"ion-col")(3,"ion-item",27)(4,"ion-label"),e._uU(5,"Open Time"),e.qZA(),e.TgZ(6,"ion-datetime",30),e.NdJ("ngModelChange",function(i){e.CHM(t);const s=e.oxw().$implicit;return e.KtG(s.startTime=i)}),e.qZA()()(),e.TgZ(7,"ion-col")(8,"ion-item",27)(9,"ion-label"),e._uU(10,"Close Time"),e.qZA(),e.TgZ(11,"ion-datetime",30),e.NdJ("ngModelChange",function(i){e.CHM(t);const s=e.oxw().$implicit;return e.KtG(s.endTime=i)}),e.qZA()()()(),e.TgZ(12,"ion-row")(13,"ion-col")(14,"ion-item")(15,"ion-label",12),e._uU(16,"Slot Duration"),e.TgZ(17,"ion-text",13),e._uU(18,"*"),e.qZA()(),e.TgZ(19,"ion-input",31),e.NdJ("ngModelChange",function(i){e.CHM(t);const s=e.oxw().$implicit;return e.KtG(s.durationInMin=i)}),e.qZA()()(),e.TgZ(20,"ion-col")(21,"ion-item")(22,"ion-label",12),e._uU(23,"Customers Per Slot"),e.TgZ(24,"ion-text",13),e._uU(25,"*"),e.qZA()(),e.TgZ(26,"ion-input",31),e.NdJ("ngModelChange",function(i){e.CHM(t);const s=e.oxw().$implicit;return e.KtG(s.slotLimit=i)}),e.qZA()()()(),e.BQk()}if(2&o){const t=e.oxw(),n=t.$implicit,i=t.index;e.xp6(6),e.Q6J("ngModel",n.startTime)("name","opnTime"+i),e.xp6(5),e.Q6J("ngModel",n.endTime)("name","closeTime"+i),e.xp6(8),e.Q6J("ngModel",n.durationInMin)("value",n.durationInMin)("name","slotDuration"+i),e.xp6(7),e.Q6J("ngModel",n.slotLimit)("value",n.slotLimit)("name","CustomersSlot"+i)}}function S(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"ion-item")(1,"ion-grid")(2,"ion-row")(3,"ion-col")(4,"ion-item",27)(5,"p",28),e._uU(6),e.ALo(7,"trimunit"),e.qZA(),e.TgZ(8,"ion-toggle",29),e.NdJ("ngModelChange",function(i){const p=e.CHM(t).$implicit;return e.KtG(p.checked=i)}),e.qZA()()()(),e.YNc(9,Z,27,10,"ng-container",3),e.qZA()()}if(2&o){const t=a.$implicit,n=a.index;e.xp6(6),e.Oqu(t.day?e.xi3(7,4,t.day,3):"-"),e.xp6(2),e.Q6J("ngModel",t.checked)("name",n+"checked"),e.xp6(1),e.Q6J("ngIf",t.checked)}}function P(o,a){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"ion-grid",7)(2,"ion-row")(3,"ion-label",8),e._uU(4,"Fill below details to complete your setup"),e.qZA()()(),e.TgZ(5,"ion-grid",9)(6,"ion-row",10)(7,"ion-col",11)(8,"ion-item")(9,"ion-label",12),e._uU(10),e.TgZ(11,"ion-text",13),e._uU(12,"*"),e.qZA()(),e.YNc(13,b,2,2,"ion-select",14),e.YNc(14,A,1,1,"ion-input",15),e.qZA(),e.TgZ(15,"ion-item")(16,"ion-label",12),e._uU(17,"Description"),e.TgZ(18,"ion-text",13),e._uU(19,"*"),e.qZA()(),e.TgZ(20,"ion-textarea",16),e.NdJ("ngModelChange",function(i){e.CHM(t);const s=e.oxw();return e.KtG(s.selectedUser.description=i)}),e.qZA()(),e.TgZ(21,"ion-item")(22,"ion-label",17),e._uU(23,"Mobile Number "),e.TgZ(24,"ion-text",13),e._uU(25,"*"),e.qZA()(),e.TgZ(26,"ion-text"),e._uU(27),e.ALo(28,"parseNumber"),e.qZA()(),e.TgZ(29,"ion-item")(30,"ion-label",12),e._uU(31),e.qZA(),e.TgZ(32,"ion-textarea",18),e.NdJ("ngModelChange",function(i){e.CHM(t);const s=e.oxw();return e.KtG(s.selectedUser.formattedAddress=i)}),e.qZA()(),e.YNc(33,U,7,2,"ion-item",3),e.qZA(),e._UZ(34,"ion-col",19),e.TgZ(35,"ion-col",20),e.YNc(36,S,10,7,"ion-item",21),e.qZA()()(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(10),e.hij("",t.vendorDeatil?t.vendorDeatil.serviceLabel:"Shop"," Name "),e.xp6(3),e.Q6J("ngIf",t.vendorDeatil.conceirge&&t.department),e.xp6(1),e.Q6J("ngIf",!t.vendorDeatil.conceirge),e.xp6(6),e.Q6J("ngModel",t.selectedUser.description),e.xp6(7),e.Oqu(e.lcZ(28,9,t.selectedUser.phonenumber)),e.xp6(4),e.Oqu(t.vendorDeatil.addressLabel?t.vendorDeatil.addressLabel:"Address"),e.xp6(1),e.Q6J("ngModel",t.selectedUser.formattedAddress),e.xp6(1),e.Q6J("ngIf",t.vendorDeatil.updateShopLocation),e.xp6(3),e.Q6J("ngForOf",t.selectedUser.availableDays)}}const K=[{path:"",component:(()=>{class o{constructor(t,n,i,s,p,m){this.appService=t,this.router=n,this.modalCtrl=i,this.activatedRoute=s,this.utilAlertService=p,this.loadingController=m,this.daysInWeek=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],this.addressList=[],this.locations=[],this.firstTime=!0,this.departments=[],this.user=new c.rB,this.selectedUser=new c.rB,this.getUserDetail(),this.getVendorDetail()}ngOnInit(){}ionViewWillEnter(){this.activatedRoute.params.subscribe(t=>{t&&(this.storeId=t.id),this.selectedAddress=void 0,this.addressList=[],this.getLocations(),this.user=JSON.parse(localStorage.getItem("user")),this.getAllServices(),this.user||(this.user=new c.rB),this.setAvailableDays()})}getCategory(){this.appService.getCategory().subscribe(t=>{t&&t.body&&t.body.length&&(this.categories=t.body)})}getAllServices(){this.department=this.departments.find(t=>{if(t&&t.name===this.user.name)return t})}onServiceChange(t){}onLocationChange(t){t&&t.detail&&t.detail.value&&(this.selectedLocation=t.detail.value)}getLocations(){this.appService.getCity().subscribe(t=>{t&&t.body&&t.body.length&&(this.locations=t.body,this.selectedUser&&this.locations&&this.locations.length&&(this.selectedLocation=this.locations.find(n=>n.locationId===this.selectedUser.locationId)))})}setAdminAvailableDays(){this.selectedUser=this.user,this.selectedUser.formattedAddress&&(this.selectedAddress={lng:this.selectedUser.lng,lat:this.selectedUser.lat,photoReference:this.selectedUser.photoReference,formattedAddress:this.selectedUser.formattedAddress}),this.daysInWeek.forEach(t=>{const n=new c.$H;n.day=t;const i=this.selectedUser.availableDays.findIndex(s=>s.day===n.day);-1===i?this.selectedUser.availableDays.push(n):this.selectedUser.availableDays[i].checked=!0})}setAvailableDays(){this.storeId?(this.selectedUser=this.user.shops.find(t=>t.phonenumber===this.storeId),this.selectedUser&&(this.selectedUser.formattedAddress&&(this.selectedAddress={lng:this.selectedUser.lng,lat:this.selectedUser.lat,photoReference:this.selectedUser.photoReference,formattedAddress:this.selectedUser.formattedAddress}),this.daysInWeek.forEach(t=>{const n=new c.$H;n.day=t;const i=this.selectedUser.availableDays.findIndex(s=>s.day===n.day);-1===i?this.selectedUser.availableDays.push(n):this.selectedUser.availableDays[i].checked=!0}))):this.setAdminAvailableDays()}checkIfSlotschecked(){let t=!1;if(this.selectedUser&&this.selectedUser.availableDays)for(const n of this.selectedUser.availableDays)if(n.checked){t=!0;break}return t}successModal(){var t=this;return(0,_.Z)(function*(n=""){return yield(yield t.modalCtrl.create({cssClass:"login-modal-page",animated:!0,showBackdrop:!0,component:x.f,componentProps:{type:t.selectedUser.type,msg:n}})).present()}).apply(this,arguments)}dismiss(){var t=this;return(0,_.Z)(function*(){yield t.modalCtrl.dismiss()})()}convertDetailBeforeSave(){return this.selectedUser.availableDays.filter(t=>t.checked)}save(){var t=this;return(0,_.Z)(function*(){let n=!0;if(!t.selectedUser.name)return n=!1,void t.utilAlertService.showAlert("Please Enter Name");if(!t.selectedUser.phonenumber)return n=!1,void t.utilAlertService.showAlert("Please Enter Phone Number");if(t.vendorDeatil.updateShopLocation&&!t.selectedLocation)return n=!1,void t.utilAlertService.showAlert("Please select Location");if(!t.checkIfSlotschecked())return n=!1,void t.utilAlertService.showAlert("Please select the slots");if(n&&t.selectedUser){t.selectedUser.availableDays=t.convertDetailBeforeSave(),t.selectedLocation&&(t.selectedUser.locationId=t.selectedLocation.locationId),t.selectedUser.idCategory=t.vendorDeatil.idCategory;const i=yield t.loadingController.create({message:"Loading..."});yield i.present(),t.appService.createStore(t.selectedUser).subscribe(s=>{if(i.dismiss(),s&&s.body){if("A"===t.user.type){const p=t.user.shops.findIndex(m=>m.userId===s.body.userId);-1!==p&&(t.user.shops[p]=s.body)}else t.user=s.body;t.successModal(),setTimeout(()=>{t.dismiss(),t.appService.setUserDetail(t.user),localStorage.setItem("user",JSON.stringify(t.user)),t.selectedUser=new c.rB,t.router.navigate("A"===t.user.type?["/user-shops"]:["/booked-customers"])},2e3)}},()=>{i.dismiss()})}})()}getUserDetail(){this.appService.userDetail.subscribe(t=>{this.user=t})}getVendorDetail(){this.appService.vendorDeatil.subscribe(t=>{t&&(this.vendorDeatil=t,this.departments=this.vendorDeatil.departments)})}searchAddress(t){this.selectedAddress=void 0;const n=t.target.value;this.addressList=[],n&&this.appService.searchShopAddress({query:n}).subscribe(s=>{console.log(s),s&&s.body&&(this.addressList=s.body)})}selectAddress(t){this.selectedAddress=t,this.addressList=[]}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(f.z),e.Y36(g.F0),e.Y36(r.IN),e.Y36(g.gz),e.Y36(M.F),e.Y36(r.HT))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-shop-keeper"]],decls:9,vars:1,consts:[[1,"container"],["name","form1",1,"shop-form"],["shopForm","ngForm"],[4,"ngIf"],[1,"shop-keeper-btn-container"],["name","submit","size","default","expand","primary","tappable","",1,"book-appointment-btn",3,"click"],[1,"mr-1"],[2,"margin","8pt 16pt"],[2,"font-size","12pt"],[1,"shop-keeper-grid"],[1,"shop-keeper-row"],[1,"shop-keeper-col","shop-keeper-detail"],["position","stacked"],["color","danger"],["name","firstname","interface","action-sheet",3,"ngModel","ngModelChange",4,"ngIf"],["type","text","name","shopName","required","",3,"ngModel","ngModelChange",4,"ngIf"],["name","desc","required","",3,"ngModel","ngModelChange"],["position","stacked",2,"opacity","1"],["name","address",3,"ngModel","ngModelChange"],["size","auto",1,"v-divider","ion-no-padding"],[1,"shop-keeper-col","shop-keeper-slot-detail"],[4,"ngFor","ngForOf"],["name","firstname","interface","action-sheet",3,"ngModel","ngModelChange"],["type","text","name","shopName","required","",3,"ngModel","ngModelChange"],["interface","action-sheet",3,"selectedText","ionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["lines","none"],[2,"width","25%"],[3,"ngModel","name","ngModelChange"],["display-format","hh:mm A","placeholder","hh:mm a","picker-format","hh:mm a","required","",3,"ngModel","name","ngModelChange"],["type","text","required","",3,"ngModel","value","name","ngModelChange"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-content")(1,"div",0)(2,"form",1,2),e.YNc(4,P,37,11,"ng-container",3),e.qZA(),e.TgZ(5,"div",4)(6,"ion-button",5),e.NdJ("click",function(){return n.save()}),e.TgZ(7,"span",6),e._uU(8,"Save"),e.qZA()()()()()),2&t&&(e.xp6(4),e.Q6J("ngIf",n.user))},dependencies:[h.sg,h.O5,d._Y,d.JJ,d.JL,d.Q7,d.On,d.F,r.YG,r.wI,r.W2,r.x4,r.jY,r.pK,r.Ie,r.Q$,r.Nd,r.t9,r.n0,r.yW,r.g2,r.ho,r.w,r.QI,r.j9,v._,y.i],styles:[".shop-form[_ngcontent-%COMP%]{height:calc(100% - 50px);overflow-y:auto}.shop-form[_ngcontent-%COMP%]   .shop-keeper-grid[_ngcontent-%COMP%]   .shop-keeper-row[_ngcontent-%COMP%]{display:grid;grid-column-gap:10px;grid-row-gap:9px}.shop-form[_ngcontent-%COMP%]   .shop-keeper-grid[_ngcontent-%COMP%]   .shop-keeper-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{display:block}.shop-form[_ngcontent-%COMP%]   .shop-keeper-grid[_ngcontent-%COMP%]   .shop-keeper-row[_ngcontent-%COMP%]   .shop-address-search[_ngcontent-%COMP%]{padding-left:0;padding-right:0}.shop-form[_ngcontent-%COMP%]   .shop-keeper-grid[_ngcontent-%COMP%]   .shop-keeper-row[_ngcontent-%COMP%]   .shop-address-search[_ngcontent-%COMP%]   .searchbar-input-container.sc-ion-searchbar-md[_ngcontent-%COMP%]{--box-shadow: none !important;border-bottom:1px solid rgba(84,80,80,.25)!important}.shop-form[_ngcontent-%COMP%]   .shop-keeper-grid[_ngcontent-%COMP%]   .shop-keeper-row[_ngcontent-%COMP%]   .v-divider[_ngcontent-%COMP%]{width:1px!important;padding:0;font-size:1px;flex:none;max-width:1px!important;border-right:1px solid #dcdcdc}.shop-form[_ngcontent-%COMP%]   .shop-keeper-grid[_ngcontent-%COMP%]   .sc-ion-label-md-h[_ngcontent-%COMP%]{font-size:12pt!important}.shop-keeper-btn-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding:4pt 16pt;position:fixed;width:100%;left:0;bottom:0;height:50px;z-index:1;margin:0}.native-input[disabled][_ngcontent-%COMP%]{opacity:1!important}"]}),o})()}];let O=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[g.Bz.forChild(K),g.Bz]}),o})();var k=l(5642);let w=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[h.ez,d.u5,r.Pc,k.K,O]}),o})()}}]);