import{a as Se}from"./chunk-BBE4BT5L.js";import{a as D,b as C}from"./chunk-EKYLXDSD.js";import{a as ue}from"./chunk-GQMNTOSR.js";import{a as fe,c as ye,e as xe}from"./chunk-RXYPHCWN.js";import{b as _e}from"./chunk-DZKO2NLF.js";import{Aa as S,Ab as q,Ba as E,Bb as z,Cb as G,D as v,Da as g,Ea as _,Ec as me,Fa as u,G as T,Gc as he,H as b,Hb as J,Kc as ge,Lb as H,M as p,Mb as Q,N as m,Oa as A,Pa as O,Pb as X,Qa as V,Qb as Y,Tb as Z,Yb as $,Za as W,Zb as ee,_a as K,_b as te,ac as ie,ca as a,da as x,eb as N,ec as ne,fc as oe,gc as re,ia as f,ka as d,la as r,ma as s,mc as se,na as L,oa as P,oc as ae,pa as I,pc as le,ra as y,rb as F,sa as U,sc as de,ta as c,tb as B,tc as ce,vc as pe,wb as k,yb as R,za as l,zb as j}from"./chunk-W2VBRA3B.js";import"./chunk-LWCOZOPT.js";import"./chunk-AZEL22PK.js";import"./chunk-B2H4I2WB.js";import"./chunk-HKZ2SCPE.js";import"./chunk-S4NCJKJW.js";import"./chunk-XOCRRRHP.js";import"./chunk-7UHV3KU6.js";import"./chunk-3ZBATJJW.js";import"./chunk-XE6OGKVL.js";import"./chunk-5AT3KRLK.js";import"./chunk-B2IEJXTH.js";import"./chunk-UBSOUGXN.js";import"./chunk-NVMJVCSP.js";import"./chunk-3H4RQUCR.js";import"./chunk-B5PDLB3A.js";import{h as M}from"./chunk-B7O3QC5Z.js";function be(o,h){if(o&1&&(r(0,"ion-select-option"),l(1),s()),o&2){let e=h.$implicit;a(),S(e.name)}}function Pe(o,h){if(o&1){let e=y();r(0,"ion-select",22),u("ngModelChange",function(t){p(e);let n=c(2);return _(n.selectedUser.name,t)||(n.selectedUser.name=t),m(t)}),f(1,be,2,1,"ion-select-option",21),s()}if(o&2){let e=c(2);g("ngModel",e.selectedUser.name),a(),d("ngForOf",e.department.services)}}function Ie(o,h){if(o&1){let e=y();r(0,"ion-input",23),u("ngModelChange",function(t){p(e);let n=c(2);return _(n.selectedUser.name,t)||(n.selectedUser.name=t),m(t)}),s()}if(o&2){let e=c(2);g("ngModel",e.selectedUser.name)}}function Ue(o,h){if(o&1&&(r(0,"ion-select-option",26),l(1),s()),o&2){let e=h.$implicit;d("value",e),a(),S(e.formattedAddress)}}function Ae(o,h){if(o&1){let e=y();r(0,"ion-item")(1,"ion-label",12),l(2,"Location"),r(3,"ion-text",13),l(4,"*"),s()(),r(5,"ion-select",24),U("ionChange",function(t){p(e);let n=c(2);return m(n.onLocationChange(t))}),f(6,Ue,2,2,"ion-select-option",25),s()()}if(o&2){let e=c(2);a(5),d("selectedText",e.selectedLocation==null?null:e.selectedLocation.formattedAddress),a(),d("ngForOf",e.locations)}}function ke(o,h){if(o&1){let e=y();P(0),r(1,"ion-row")(2,"ion-col")(3,"ion-item",27)(4,"ion-label"),l(5,"Open Time"),s(),r(6,"ion-datetime",30),u("ngModelChange",function(t){p(e);let n=c().$implicit;return _(n.startTime,t)||(n.startTime=t),m(t)}),s()()(),r(7,"ion-col")(8,"ion-item",27)(9,"ion-label"),l(10,"Close Time"),s(),r(11,"ion-datetime",30),u("ngModelChange",function(t){p(e);let n=c().$implicit;return _(n.endTime,t)||(n.endTime=t),m(t)}),s()()()(),r(12,"ion-row")(13,"ion-col")(14,"ion-item")(15,"ion-label",12),l(16,"Slot Duration"),r(17,"ion-text",13),l(18,"*"),s()(),r(19,"ion-input",31),u("ngModelChange",function(t){p(e);let n=c().$implicit;return _(n.durationInMin,t)||(n.durationInMin=t),m(t)}),s()()(),r(20,"ion-col")(21,"ion-item")(22,"ion-label",12),l(23,"Customers Per Slot"),r(24,"ion-text",13),l(25,"*"),s()(),r(26,"ion-input",31),u("ngModelChange",function(t){p(e);let n=c().$implicit;return _(n.slotLimit,t)||(n.slotLimit=t),m(t)}),s()()()(),I()}if(o&2){let e=c(),i=e.$implicit,t=e.index;a(6),g("ngModel",i.startTime),d("name","opnTime"+t),a(5),g("ngModel",i.endTime),d("name","closeTime"+t),a(8),g("ngModel",i.durationInMin),d("value",i.durationInMin)("name","slotDuration"+t),a(7),g("ngModel",i.slotLimit),d("value",i.slotLimit)("name","CustomersSlot"+t)}}function De(o,h){if(o&1){let e=y();r(0,"ion-item")(1,"ion-grid")(2,"ion-row")(3,"ion-col")(4,"ion-item",27)(5,"p",28),l(6),A(7,"trimunit"),s(),r(8,"ion-toggle",29),u("ngModelChange",function(t){let n=p(e).$implicit;return _(n.checked,t)||(n.checked=t),m(t)}),s()()()(),f(9,ke,27,10,"ng-container",3),s()()}if(o&2){let e=h.$implicit,i=h.index;a(6),S(e.day?V(7,4,e.day,3):"-"),a(2),g("ngModel",e.checked),d("name",i+"checked"),a(),d("ngIf",e.checked)}}function Te(o,h){if(o&1){let e=y();P(0),r(1,"ion-grid",7)(2,"ion-row")(3,"ion-label",8),l(4,"Fill below details to complete your setup"),s()()(),r(5,"ion-grid",9)(6,"ion-row",10)(7,"ion-col",11)(8,"ion-item")(9,"ion-label",12),l(10),r(11,"ion-text",13),l(12,"*"),s()(),f(13,Pe,2,2,"ion-select",14)(14,Ie,1,1,"ion-input",15),s(),r(15,"ion-item")(16,"ion-label",12),l(17,"Description"),r(18,"ion-text",13),l(19,"*"),s()(),r(20,"ion-textarea",16),u("ngModelChange",function(t){p(e);let n=c();return _(n.selectedUser.description,t)||(n.selectedUser.description=t),m(t)}),s()(),r(21,"ion-item")(22,"ion-label",17),l(23,"Mobile Number "),r(24,"ion-text",13),l(25,"*"),s()(),r(26,"ion-text"),l(27),A(28,"parseNumber"),s()(),r(29,"ion-item")(30,"ion-label",12),l(31),s(),r(32,"ion-textarea",18),u("ngModelChange",function(t){p(e);let n=c();return _(n.selectedUser.formattedAddress,t)||(n.selectedUser.formattedAddress=t),m(t)}),s()(),f(33,Ae,7,2,"ion-item",3),s(),L(34,"ion-col",19),r(35,"ion-col",20),f(36,De,10,7,"ion-item",21),s()()(),I()}if(o&2){let e=c();a(10),E("",e.vendorDeatil?e.vendorDeatil.serviceLabel:"Shop"," Name "),a(3),d("ngIf",e.vendorDeatil.conceirge&&e.department),a(),d("ngIf",!e.vendorDeatil.conceirge),a(6),g("ngModel",e.selectedUser.description),a(7),S(O(28,9,e.selectedUser.phonenumber)),a(4),S(e.vendorDeatil.addressLabel?e.vendorDeatil.addressLabel:"Address"),a(),g("ngModel",e.selectedUser.formattedAddress),a(),d("ngIf",e.vendorDeatil.updateShopLocation),a(3),d("ngForOf",e.selectedUser.availableDays)}}var we=(()=>{class o{constructor(e,i,t,n,w,ve){this.appService=e,this.router=i,this.modalCtrl=t,this.activatedRoute=n,this.utilAlertService=w,this.loadingController=ve,this.daysInWeek=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],this.addressList=[],this.locations=[],this.firstTime=!0,this.departments=[],this.user=new C,this.selectedUser=new C,this.getUserDetail(),this.getVendorDetail()}ngOnInit(){}ionViewWillEnter(){this.activatedRoute.params.subscribe(e=>{e&&(this.storeId=e.id),this.selectedAddress=void 0,this.addressList=[],this.getLocations(),this.user=JSON.parse(localStorage.getItem("user")),this.getAllServices(),this.user?this.setAvailableDays():(this.user=new C,this.setAvailableDays())})}getCategory(){this.appService.getCategory().subscribe(e=>{e&&e.body&&e.body.length&&(this.categories=e.body)})}getAllServices(){this.department=this.departments.find(e=>{if(e&&e.name===this.user.name)return e})}onServiceChange(e){}onLocationChange(e){e&&e.detail&&e.detail.value&&(this.selectedLocation=e.detail.value)}getLocations(){this.appService.getCity().subscribe(e=>{e&&e.body&&e.body.length&&(this.locations=e.body,this.selectedUser&&this.locations&&this.locations.length&&(this.selectedLocation=this.locations.find(i=>i.locationId===this.selectedUser.locationId)))})}setAdminAvailableDays(){this.selectedUser=this.user,this.selectedUser.formattedAddress&&(this.selectedAddress={lng:this.selectedUser.lng,lat:this.selectedUser.lat,photoReference:this.selectedUser.photoReference,formattedAddress:this.selectedUser.formattedAddress}),this.daysInWeek.forEach(e=>{let i=new D;i.day=e;let t=this.selectedUser.availableDays.findIndex(n=>n.day===i.day);t===-1?this.selectedUser.availableDays.push(i):this.selectedUser.availableDays[t].checked=!0})}setAvailableDays(){if(!this.storeId){this.setAdminAvailableDays();return}this.selectedUser=this.user.shops.find(e=>e.phonenumber===this.storeId),this.selectedUser&&(this.selectedUser.formattedAddress&&(this.selectedAddress={lng:this.selectedUser.lng,lat:this.selectedUser.lat,photoReference:this.selectedUser.photoReference,formattedAddress:this.selectedUser.formattedAddress}),this.daysInWeek.forEach(e=>{let i=new D;i.day=e;let t=this.selectedUser.availableDays.findIndex(n=>n.day===i.day);t===-1?this.selectedUser.availableDays.push(i):this.selectedUser.availableDays[t].checked=!0}))}checkIfSlotschecked(){let e=!1;if(this.selectedUser&&this.selectedUser.availableDays){for(let i of this.selectedUser.availableDays)if(i.checked){e=!0;break}}return e}successModal(e=""){return M(this,null,function*(){return yield(yield this.modalCtrl.create({cssClass:"login-modal-page",animated:!0,showBackdrop:!0,component:Se,componentProps:{type:this.selectedUser.type,msg:e}})).present()})}dismiss(){return M(this,null,function*(){yield this.modalCtrl.dismiss()})}convertDetailBeforeSave(){return this.selectedUser.availableDays.filter(e=>e.checked)}save(){return M(this,null,function*(){let e=!0;if(!this.selectedUser.name){e=!1,this.utilAlertService.showAlert("Please Enter Name");return}if(!this.selectedUser.phonenumber){e=!1,this.utilAlertService.showAlert("Please Enter Phone Number");return}if(this.vendorDeatil.updateShopLocation&&!this.selectedLocation){e=!1,this.utilAlertService.showAlert("Please select Location");return}if(!this.checkIfSlotschecked()){e=!1,this.utilAlertService.showAlert("Please select the slots");return}if(e&&this.selectedUser){this.selectedUser.availableDays=this.convertDetailBeforeSave(),this.selectedLocation&&(this.selectedUser.locationId=this.selectedLocation.locationId),this.selectedUser.idCategory=this.vendorDeatil.idCategory;let i=yield this.loadingController.create({message:"Loading..."});yield i.present(),this.appService.createStore(this.selectedUser).subscribe(t=>{if(i.dismiss(),t&&t.body){if(this.user.type==="A"){let n=this.user.shops.findIndex(w=>w.userId===t.body.userId);n!==-1&&(this.user.shops[n]=t.body)}else this.user=t.body;this.successModal(),setTimeout(()=>{this.dismiss(),this.appService.setUserDetail(this.user),localStorage.setItem("user",JSON.stringify(this.user)),this.selectedUser=new C,this.user.type==="A"?this.router.navigate(["/user-shops"]):this.router.navigate(["/booked-customers"])},2e3)}},()=>{i.dismiss()})}})}getUserDetail(){this.appService.userDetail.subscribe(e=>{this.user=e})}getVendorDetail(){this.appService.vendorDeatil.subscribe(e=>{e&&(this.vendorDeatil=e,this.departments=this.vendorDeatil.departments)})}searchAddress(e){this.selectedAddress=void 0;let i=e.target.value;if(this.addressList=[],i){let t={query:i};this.appService.searchShopAddress(t).subscribe(n=>{console.log(n),n&&n.body&&(this.addressList=n.body)})}}selectAddress(e){this.selectedAddress=e,this.addressList=[]}static{this.\u0275fac=function(i){return new(i||o)(x(_e),x(B),x(he),x(F),x(ue),x(me))}}static{this.\u0275cmp=T({type:o,selectors:[["app-shop-keeper"]],decls:9,vars:1,consts:[["shopForm","ngForm"],[1,"container"],["name","form1",1,"shop-form"],[4,"ngIf"],[1,"shop-keeper-btn-container"],["name","submit","size","default","expand","primary","tappable","",1,"book-appointment-btn",3,"click"],[1,"mr-1"],[2,"margin","8pt 16pt"],[2,"font-size","12pt"],[1,"shop-keeper-grid"],[1,"shop-keeper-row"],[1,"shop-keeper-col","shop-keeper-detail"],["position","stacked"],["color","danger"],["name","firstname","interface","action-sheet",3,"ngModel","ngModelChange",4,"ngIf"],["type","text","name","shopName","required","",3,"ngModel","ngModelChange",4,"ngIf"],["name","desc","required","",3,"ngModelChange","ngModel"],["position","stacked",2,"opacity","1"],["name","address",3,"ngModelChange","ngModel"],["size","auto",1,"v-divider","ion-no-padding"],[1,"shop-keeper-col","shop-keeper-slot-detail"],[4,"ngFor","ngForOf"],["name","firstname","interface","action-sheet",3,"ngModelChange","ngModel"],["type","text","name","shopName","required","",3,"ngModelChange","ngModel"],["interface","action-sheet",3,"ionChange","selectedText"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["lines","none"],[2,"width","25%"],[3,"ngModelChange","ngModel","name"],["display-format","hh:mm A","placeholder","hh:mm a","picker-format","hh:mm a","required","",3,"ngModelChange","ngModel","name"],["type","text","required","",3,"ngModelChange","ngModel","value","name"]],template:function(i,t){if(i&1){let n=y();r(0,"ion-content")(1,"div",1)(2,"form",2,0),f(4,Te,37,11,"ng-container",3),s(),r(5,"div",4)(6,"ion-button",5),U("click",function(){return p(n),m(t.save())}),r(7,"span",6),l(8,"Save"),s()()()()()}i&2&&(a(4),d("ngIf",t.user))},dependencies:[W,K,G,R,j,J,z,q,Z,$,ee,te,ie,ne,oe,re,se,ae,le,de,ce,pe,Q,X,Y,fe,ye],styles:[".shop-form[_ngcontent-%COMP%]{height:calc(100% - 50px);overflow-y:auto}.shop-form[_ngcontent-%COMP%]   .shop-keeper-grid[_ngcontent-%COMP%]   .shop-keeper-row[_ngcontent-%COMP%]{display:grid;grid-column-gap:10px;grid-row-gap:9px}.shop-form[_ngcontent-%COMP%]   .shop-keeper-grid[_ngcontent-%COMP%]   .shop-keeper-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{display:block}.shop-form[_ngcontent-%COMP%]   .shop-keeper-grid[_ngcontent-%COMP%]   .shop-keeper-row[_ngcontent-%COMP%]   .shop-address-search[_ngcontent-%COMP%]{padding-left:0;padding-right:0}.shop-form[_ngcontent-%COMP%]   .shop-keeper-grid[_ngcontent-%COMP%]   .shop-keeper-row[_ngcontent-%COMP%]   .shop-address-search[_ngcontent-%COMP%]   .searchbar-input-container.sc-ion-searchbar-md[_ngcontent-%COMP%]{--box-shadow: none !important;border-bottom:1px solid rgba(84,80,80,.25)!important}.shop-form[_ngcontent-%COMP%]   .shop-keeper-grid[_ngcontent-%COMP%]   .shop-keeper-row[_ngcontent-%COMP%]   .v-divider[_ngcontent-%COMP%]{width:1px!important;padding:0;font-size:1px;-webkit-box-flex:0;flex:none;max-width:1px!important;border-right:1px solid #dcdcdc}.shop-form[_ngcontent-%COMP%]   .shop-keeper-grid[_ngcontent-%COMP%]   .sc-ion-label-md-h[_ngcontent-%COMP%]{font-size:12pt!important}.shop-keeper-btn-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding:4pt 16pt;position:fixed;width:100%;left:0;bottom:0;height:50px;z-index:1;margin:0}.native-input[disabled][_ngcontent-%COMP%]{opacity:1!important}"]})}}return o})();var Le=[{path:"",component:we}],Me=(()=>{class o{static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275mod=b({type:o})}static{this.\u0275inj=v({imports:[k.forChild(Le),k]})}}return o})();var st=(()=>{class o{static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275mod=b({type:o})}static{this.\u0275inj=v({imports:[N,H,ge,xe,Me]})}}return o})();export{st as ShopKeeperPageModule};
